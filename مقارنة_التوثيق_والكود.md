# ๐ ููุงุฑูุฉ ูุจุงุดุฑุฉ: ุงูุชูุซูู vs ุงูููุฏ ุงููุนูู

## ุชุงุฑูุฎ ุงูููุงุฑูุฉ: 25 ุฃูุชูุจุฑ 2025

---

## ๐ ุงูููุงุฑูุฉ ุงูุฑุฆูุณูุฉ

### 1. Domain ุงูุฅูุชุงุฌ

| ุงูููุถุน | ุงูุชูุซูู | ุงูููุฏ ุงููุนูู | ุงูุญุงูุฉ |
|--------|---------|---------------|--------|
| Environment Variable | `mandhoor.com` | `taearif.com` | โ ูุฎุชูู |
| Data Stream | `https://mandhoor.com` | ุบูุฑ ูุญุฏุฏ | โ๏ธ |
| Excluded Domains | `www.mandhoor.com`, `mandhoor.com` | ูุณุชุฎุฏู ูุชุบูุฑ ุงูุจูุฆุฉ | โ๏ธ |
| Cookie Domain | `.mandhoor.com` | `.mandhoor.com` (ููุซุจุช) | โ ุฎุทุฃ |
| Examples | `hey.mandhoor.com` | `hey.taearif.com` ูู ุงูููุฏ | โ ูุฎุชูู |

**ุงูุฎูุงุตุฉ:** ุชูุงูุถ ูุงูู - ุงูุชูุซูู ูุฐูุฑ `mandhoor.com` ูุงูููุฏ ูุณุชุฎุฏู `taearif.com`

---

### 2. GTM Container ID

| ุงูููุถุน | ุงูุชูุซูู | ุงูููุฏ ุงููุนูู | ุงูุญุงูุฉ |
|--------|---------|---------------|--------|
| Documentation | `GTM-KBL37C9T` | - | - |
| env.txt | - | `GTM-KS62NNTG` | โ ูุฎุชูู |
| GTMProvider.tsx | - | `GTM-KS62NNTG` (default) | โ ูุฎุชูู |
| GTMProvider2.tsx | - | `GTM-KBL37C9T` (default) | โ ูุทุงุจู |
| app/layout.tsx | `GTM-KBL37C9T` | `GTM-KBL37C9T` | โ ูุทุงุจู |
| app/dashboard/layout.tsx | `GTM-KBL37C9T` | `GTM-KBL37C9T` | โ ูุทุงุจู |

**ุงูุฎูุงุตุฉ:** ูุฌูุฏ **ุงุซููู** ูู Container IDs ูุฎุชููุฉ - `GTM-KS62NNTG` ู `GTM-KBL37C9T`

---

### 3. GA4 Measurement IDs

| ุงููุชุบูุฑ | ุงูุชูุซูู | ุงูููุฏ ุงููุนูู | ุงูุญุงูุฉ |
|---------|---------|---------------|--------|
| NEXT_PUBLIC_GA4_ID | `G-WTN83NMVW1` | `G-WTN83NMVW1` | โ ูุทุงุจู |
| NEXT_PUBLIC_GA4_LEGACY_ID | `G-RVFKM2F9ZN` | ุบูุฑ ููุฌูุฏ | โ ููููุฏ |

**ุงูุฎูุงุตุฉ:** GA4 ID ุงูุฑุฆูุณู ุตุญูุญุ ููู Legacy ID ููููุฏ

---

### 4. ุฅุณุชุฑุงุชูุฌูุฉ GA4/GTM

#### ุงูุชูุซูู ูููู:

```json
{
  "criticalNotes": {
    "separation": "GA4 and GTM NEVER work together on the same page",
    "tenantSubdomains": "Tenant subdomains use ONLY GA4, NEVER GTM",
    "adminPages": "Admin pages use ONLY GTM, NEVER GA4"
  }
}
```

#### ุงูููุฏ ุงููุนูู:

**HomePageWrapper.tsx:**
```typescript
<GTMProvider>              // โ GTM ููุฌูุฏ
  <GA4Provider>            // โ GA4 ููุฌูุฏ
    {/* content */}
  </GA4Provider>
</GTMProvider>
```

**TenantPageWrapper.tsx:**
```typescript
<GTMProvider>              // โ GTM ููุฌูุฏ
  <GA4Provider>            // โ GA4 ููุฌูุฏ
    {/* content */}
  </GA4Provider>
</GTMProvider>
```

**PropertyPageWrapper.tsx:**
```typescript
<GTMProvider>              // โ GTM ููุฌูุฏ
  <GA4Provider>            // โ GA4 ููุฌูุฏ
    {/* content */}
  </GA4Provider>
</GTMProvider>
```

**ProjectPageWrapper.tsx:**
```typescript
<GTMProvider>              // โ GTM ููุฌูุฏ
  <GA4Provider>            // โ GA4 ููุฌูุฏ
    {/* content */}
  </GA4Provider>
</GTMProvider>
```

**ุงูุฎูุงุตุฉ:** โโโ **ุชูุงูุถ ูุงูู** - ุฌููุน tenant pages ุชุณุชุฎุฏู GTM ู GA4 ูุนุงู!

---

### 5. ุงููููุงุช ูุงูููููุงุช

| ุงููููู | ุงูุชูุซูู | ุงูููุฏ ุงููุนูู | ุงูุญุงูุฉ |
|--------|---------|---------------|--------|
| GA4Provider | `components/GA4Provider.tsx` | `components/GA4Provider.tsx` | โ ููุฌูุฏ |
| GTMProvider | `components/GTMProvider.tsx` | `components/GTMProvider.tsx` | โ ููุฌูุฏ |
| GTMProvider2 | ุบูุฑ ูุฐููุฑ | `components/GTMProvider2.tsx` | โ๏ธ ููุฌูุฏ ููู ุบูุฑ ููุซู |
| ga4-tracking.ts | `lib/ga4-tracking.ts` | `lib/ga4-tracking.ts` | โ ููุฌูุฏ |
| gtm.ts | `lib/gtm.ts` | `lib/gtm.ts` | โ ููุฌูุฏ |
| middleware.ts | `middleware.ts` | `middleware.ts` | โ ููุฌูุฏ |

**ุงูุฎูุงุตุฉ:** ุฌููุน ุงููููุงุช ููุฌูุฏุฉ + GTMProvider2 ุฅุถุงูู ุบูุฑ ููุซู

---

### 6. ูุธุงุฆู GA4 Tracking

| ุงููุธููุฉ | ุงูุชูุซูู | ุงูููุฏ ุงููุนูู | ุงูุญุงูุฉ |
|---------|---------|---------------|--------|
| initializeGA4() | โ ููุซู | โ ููุฌูุฏ | โ ูุทุงุจู |
| trackPageView() | โ ููุซู | โ ููุฌูุฏ | โ ูุทุงุจู |
| trackPropertyView() | โ ููุซู | โ ููุฌูุฏ | โ ูุทุงุจู |
| trackProjectView() | โ ููุซู | โ ููุฌูุฏ | โ ูุทุงุจู |
| trackContactForm() | โ ููุซู | โ ููุฌูุฏ | โ ูุทุงุจู |
| trackSearch() | โ ููุซู | โ ููุฌูุฏ | โ ูุทุงุจู |
| setTenantContext() | โ ููุซู | โ ููุฌูุฏ | โ ูุทุงุจู |
| shouldTrackDomain() | โ ููุซู | โ ููุฌูุฏ (ุฏุงุฎูู) | โ ูุทุงุจู |
| getTenantIdFromDomain() | โ ููุซู | โ ููุฌูุฏ (ุฏุงุฎูู) | โ ูุทุงุจู |
| isGA4Ready() | โ ููุซู | โ ููุฌูุฏ (ุฏุงุฎูู) | โ ูุทุงุจู |

**ุงูุฎูุงุตุฉ:** โ ุฌููุน ุงููุธุงุฆู ููุฌูุฏุฉ ูููููุฐุฉ ุจุดูู ุตุญูุญ

---

### 7. ูุธุงุฆู GTM

| ุงููุธููุฉ | ุงูุชูุซูู | ุงูููุฏ ุงููุนูู | ุงูุญุงูุฉ |
|---------|---------|---------------|--------|
| initDataLayer() | โ ููุซู | โ ููุฌูุฏ | โ ูุทุงุจู |
| trackEvent() | โ ููุซู | โ ููุฌูุฏ | โ ูุทุงุจู |
| trackPageView() | โ ููุซู | โ ููุฌูุฏ | โ ูุทุงุจู |
| trackConversion() | โ ููุซู | โ ููุฌูุฏ | โ ูุทุงุจู |
| trackPurchase() | โ ููุซู | โ ููุฌูุฏ | โ ูุทุงุจู |
| trackUserInteraction() | โ ุบูุฑ ููุซู | โ ููุฌูุฏ | โ๏ธ ุฅุถุงูู |
| trackFormSubmission() | โ ุบูุฑ ููุซู | โ ููุฌูุฏ | โ๏ธ ุฅุถุงูู |
| trackButtonClick() | โ ุบูุฑ ููุซู | โ ููุฌูุฏ | โ๏ธ ุฅุถุงูู |
| trackNavigation() | โ ุบูุฑ ููุซู | โ ููุฌูุฏ | โ๏ธ ุฅุถุงูู |
| trackSearch() | โ ุบูุฑ ููุซู | โ ููุฌูุฏ | โ๏ธ ุฅุถุงูู |
| trackLogin() | โ ุบูุฑ ููุซู | โ ููุฌูุฏ | โ๏ธ ุฅุถุงูู |
| trackSignup() | โ ุบูุฑ ููุซู | โ ููุฌูุฏ | โ๏ธ ุฅุถุงูู |
| trackError() | โ ุบูุฑ ููุซู | โ ููุฌูุฏ | โ๏ธ ุฅุถุงูู |

**ุงูุฎูุงุตุฉ:** ุงููุธุงุฆู ุงูููุซูุฉ ููุฌูุฏุฉ + **8 ูุธุงุฆู ุฅุถุงููุฉ** ุบูุฑ ููุซูุฉ

---

### 8. Reserved Words

#### ุงูุชูุซูู:
```json
[
  "www", "api", "admin", "app", "mail", "ftp",
  "blog", "shop", "store", "dashboard", "live-editor",
  "auth", "login", "register"
]
```

#### ุงูููุฏ (middleware.ts ุงูุณุทุฑ 72-87):
```typescript
const reservedWords = [
  "www", "api", "admin", "app", "mail", "ftp",
  "blog", "shop", "store", "dashboard", "live-editor",
  "auth", "login", "register",
];
```

**ุงูุฎูุงุตุฉ:** โ **ูุทุงุจูุฉ 100%**

---

### 9. GA4 Configuration

| ุงูุฅุนุฏุงุฏ | ุงูุชูุซูู | ุงูููุฏ ุงููุนูู | ุงูุญุงูุฉ |
|---------|---------|---------------|--------|
| custom_map.dimension1 | `"tenant_id"` | `"tenant_id"` | โ ูุทุงุจู |
| cookie_domain | `".mandhoor.com"` | `".mandhoor.com"` | โ๏ธ ููุซุจุช |
| transport_type | `"beacon"` | `"beacon"` | โ ูุทุงุจู |

**ุงูุฎูุงุตุฉ:** ุงูุฅุนุฏุงุฏุงุช ุตุญูุญุฉ ููู `cookie_domain` ููุซุจุช ุจุฏูุงู ูู ุฃู ูููู ุฏููุงูููู

---

### 10. ุตูุญุงุช GA4

#### ุงูุชูุซูู ูุฐูุฑ 4 ุตูุญุงุช:

| ุงูุตูุญุฉ | Wrapper | ุงูููุฏ ุงููุนูู | ุงูุญุงูุฉ |
|--------|---------|---------------|--------|
| `app/page.tsx` | HomePageWrapper | โ ููุฌูุฏ | โ ูุทุงุจู |
| `app/[slug]/page.tsx` | TenantPageWrapper | โ ููุฌูุฏ | โ ูุทุงุจู |
| `app/property/[id]/page.tsx` | PropertyPageWrapper | โ ููุฌูุฏ | โ ูุทุงุจู |
| `app/project/[id]/page.tsx` | ProjectPageWrapper | โ ููุฌูุฏ | โ ูุทุงุจู |

**ุงูุฎูุงุตุฉ:** โ ุฌููุน ุงูุตูุญุงุช ููุฌูุฏุฉ ูููููุฐุฉ

**ููู:** โ ูููุง ุชุณุชุฎุฏู GTM ู GA4 ูุนุงู (ูุฎุงูู ููุชูุซูู)

---

### 11. Middleware Headers

#### ุงูุชูุซูู:
```json
{
  "headers": {
    "x-tenant-id": "Tenant identifier",
    "x-locale": "Language locale",
    "x-pathname": "Current page path"
  }
}
```

#### ุงูููุฏ (middleware.ts):
```typescript
response.headers.set("x-locale", locale);              // โ
response.headers.set("x-html-lang", locale);           // โ๏ธ ุฅุถุงูู
response.headers.set("x-pathname", pathnameWithoutLocale); // โ
response.headers.set("x-tenant-id", tenantId);         // โ
response.headers.set("x-domain-type", domainType);     // โ๏ธ ุฅุถุงูู
```

**ุงูุฎูุงุตุฉ:** Headers ุงูููุซูุฉ ููุฌูุฏุฉ + **2 headers ุฅุถุงููุฉ**

---

### 12. Console Logs

#### ุงูุชูุซูู ูุฐูุฑ:

```json
{
  "consoleLogs": [
    "๐ GA4: Checking domain: [domain]",
    "โ GA4: Tenant subdomain (production): [domain]",
    "โ GA4: Main domain excluded: [domain]",
    "๐ GA4: Starting initialization with ID: [ga4Id]",
    "โ GA4: Script loaded successfully",
    "โ GA4: Configuration complete",
    "โ๏ธ GA4: Not ready yet, retrying in 100ms"
  ]
}
```

#### ุงูููุฏ ุงููุนูู:

```typescript
// ูู lib/ga4-tracking.ts:
console.log("๐ซ GA4: Skipping tracking for domain:", currentDomain); // ุงูุณุทุฑ 27
console.log("โ GA4: Script loaded successfully");                    // ุงูุณุทุฑ 45
console.log("โ GA4: Configuration complete");                        // ุงูุณุทุฑ 56
console.error("โ GA4: Failed to load script");                       // ุงูุณุทุฑ 60
console.warn("โ๏ธ GA4: Not ready yet, retrying in 100ms");            // ุงูุณุทุฑ 146
```

**ุงูุฎูุงุตุฉ:** ูุนุธู ุงูู logs ููุฌูุฏุฉ ููู ุจุนุถูุง ูุฎุชูู ููููุงู

---

### 13. Real World Example

#### ุงูุชูุซูู ูุฐูุฑ:

```json
{
  "scenario": "User visits http://vcvkkokk.localhost:3000/ar/property/shk-gdyd-llaygar-1",
  "consoleOutput": [
    "๐ GA4: Production domain: mandhoor.com"
  ]
}
```

#### ุงููุงูุน:

Console ุณููุธูุฑ:
```
๐ GA4: Production domain: taearif.com
```

**ุงูุฎูุงุตุฉ:** โ ุงููุซุงู ูู ุงูุชูุซูู ุณููุธูุฑ `mandhoor.com` ููู ุงูููุฏ ุงููุนูู ุณููุธูุฑ `taearif.com`

---

## ๐ ุงูุฅุญุตุงุฆูุงุช ุงูููุงุฆูุฉ

### ูุณุชูู ุงูุชุทุงุจู

| ุงููุฆุฉ | ุงููุณุจุฉ | ุงูุญุงูุฉ |
|-------|--------|--------|
| ุงููููุงุช ูุงูููููุงุช | 95% | โ ููุชุงุฒ |
| ุงููุธุงุฆู ุงูุฃุณุงุณูุฉ | 100% | โ ูุซุงูู |
| ุงูุชููููุงุช | 30% | โ ุถุนูู |
| ุงูุฅุณุชุฑุงุชูุฌูุฉ | 0% | โโโ ุชูุงูุถ ูุงูู |
| ูุชุบูุฑุงุช ุงูุจูุฆุฉ | 40% | โ ุถุนูู |

### ุงูุฃุฎุทุงุก ุญุณุจ ุงูููุน

| ุงูููุน | ุงูุนุฏุฏ | ุงููุณุจุฉ |
|-------|-------|--------|
| ุชูุงูุถุงุช ูุงููุฉ | 2 | 22% |
| ููู ูุฎุชููุฉ | 3 | 33% |
| ุนูุงุตุฑ ููููุฏุฉ | 2 | 22% |
| ุนูุงุตุฑ ุฅุถุงููุฉ | 2 | 22% |

---

## ๐ฏ ุงูุฎูุงุตุฉ ุงูุนุงูุฉ

### โ ูุง ูุนูู ุจุดูู ุตุญูุญ:

1. **ุงูุจููุฉ ุงูุฃุณุงุณูุฉ:** ุฌููุน ุงููููุงุช ููุฌูุฏุฉ
2. **ุงููุธุงุฆู:** ุฌููุน ุงููุธุงุฆู ููููุฐุฉ ูุชุนูู
3. **Reserved Words:** ูุทุงุจูุฉ ุชูุงูุงู
4. **ุงูุตูุญุงุช:** ุฌููุน ุงูุตูุญุงุช ุงููุฐููุฑุฉ ููุฌูุฏุฉ

### โ ูุง ูุง ูุทุงุจู ุงูุชูุซูู:

1. **Domain:** ุงูุชูุซูู `mandhoor.com` - ุงูููุฏ `taearif.com`
2. **GTM ID:** IDs ูุชุนุฏุฏุฉ ููุชูุงูุถุฉ
3. **GA4/GTM Strategy:** ุชูุงูุถ ูุงูู - ูุนููุงู ูุนุงู ูู ุงูููุฏ
4. **Cookie Domain:** ููุซุจุช ุจุฏูุงู ูู ุฏููุงูููู

### โ๏ธ ุงูุชุฃุซูุฑ ุงูููู:

- **ุงูุชุชุจุน ูุฏ ูุง ูุนูู** ุจุดูู ุตุญูุญ ูู ุงูุฅูุชุงุฌ
- **ุงูุจูุงูุงุช ูุฏ ุชููู ูููุณูุฉ** ุจูู GTM containers
- **ุชุชุจุน ูุฒุฏูุฌ** ูุญุฏุซ ูู tenant pages
- **ุงูุชูุซูู ุบูุฑ ููุซูู** ููุญุชุงุฌ ูุชุญุฏูุซ ุดุงูู

---

## ๐ ุงูุชูุตูุฉ ุงูููุงุฆูุฉ

**ูุฌุจ ุฅุตูุงุญ ุงูุฃุฎุทุงุก ุงูุญุฑุฌุฉ ููุฑุงู ูุจู ุงููุดุฑ ูู ุงูุฅูุชุงุฌ:**

1. โ ุชูุญูุฏ Domain
2. โ ุชูุญูุฏ GTM Container ID
3. โ ุฅุฒุงูุฉ GTM ูู Tenant Pages
4. โ ุฌุนู Cookie Domain ุฏููุงูููู

**ุจุนุฏ ุฐูู:**

5. โ ุชุญุฏูุซ ุงูุชูุซูู ุจุงููุงูู
6. โ ุฅุถุงูุฉ ุงุฎุชุจุงุฑุงุช ุชููุงุฆูุฉ
7. โ ูุฑุงุฌุนุฉ ุฏูุฑูุฉ ููุชุทุงุจู

---

**ุชุงุฑูุฎ ุงูููุงุฑูุฉ:** 25 ุฃูุชูุจุฑ 2025
**ุงูุญุงูุฉ:** ููุชูู โ
**ุงูุชูููู:** ูุญุชุงุฌ ูุฅุตูุงุญุงุช ุญุฑุฌุฉ

---


