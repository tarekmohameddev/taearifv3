# Cursor AI Rules - Website Builder Dashboard Project

## ğŸ¯ PROJECT CONTEXT

This is a **Live Editor System** for building websites dynamically with a component-based architecture using Next.js, React, TypeScript, and Zustand.

---

## ğŸ“š CRITICAL DOCUMENTATION - ALWAYS REFERENCE

### **BEFORE ANY CODE CHANGES:**
1. **READ** relevant documentation from `docs/important/`
2. **UNDERSTAND** the architecture and patterns
3. **FOLLOW** existing conventions strictly
4. **UPDATE** documentation if implementation changes

---

## ğŸ“‚ DOCUMENTATION HIERARCHY

### **ğŸ”´ TIER 1: MUST READ FOR ANY COMPONENT WORK**

```
docs/important/components/
â”œâ”€â”€ ADD_NEW_COMPONENT.md              â† Complete guide for creating components
â”œâ”€â”€ ADD_NEW_COMPONENT_PROMPT.md       â† AI prompts for component creation
â”œâ”€â”€ FIX_COMPONENT_PROMPT.md           â† Diagnostic & repair system
â”œâ”€â”€ FIX_COMPONENT_QUICK_START.md      â† Quick repair reference
â””â”€â”€ README.md                         â† Component system overview
```

**RULE:** When working with components, ALWAYS reference these files first.

---

### **ğŸ”´ TIER 1: MUST READ FOR LIVE EDITOR WORK**

```
docs/important/liveEditor/
â”œâ”€â”€ README.md                         â† Start here for Live Editor
â”œâ”€â”€ OVERVIEW.md                       â† System overview
â”œâ”€â”€ COMPONENT_ARCHITECTURE.md         â† Component architecture deep dive
â”œâ”€â”€ STATE_MANAGEMENT.md               â† Zustand state management
â”œâ”€â”€ DATA_FLOW.md                      â† Data flow patterns
â”œâ”€â”€ QUICK_START.md                    â† Quick start guide
â”œâ”€â”€ CORE_CONCEPTS.md                  â† Core concepts
â”œâ”€â”€ COMMON_PATTERNS.md                â† Common patterns
â”œâ”€â”€ PRACTICAL_EXAMPLES.md             â† Real examples
â”œâ”€â”€ TROUBLESHOOTING.md                â† Problem solving
â””â”€â”€ context/
    â”œâ”€â”€ README.md                     â† Context system overview
    â”œâ”€â”€ COMPONENT_INTEGRATION.md      â† How components integrate
    â”œâ”€â”€ EDITOR_STORE_FUNCTIONS.md     â† Store functions reference
    â”œâ”€â”€ STORES_OVERVIEW.md            â† All stores explained
    â””â”€â”€ SUMMARY.md                    â† Quick summary
```

**RULE:** For any editorStore, context, or state changes â†’ READ relevant docs.

---

### **ğŸŸ¡ TIER 2: REFERENCE FOR SPECIFIC FEATURES**

```
docs/important/liveEditor/editorSidebar/
â”œâ”€â”€ README.md                         â† EditorSidebar overview
â”œâ”€â”€ OVERVIEW.md                       â† System overview
â”œâ”€â”€ COMPONENTS.md                     â† Components breakdown
â”œâ”€â”€ DATA_FLOW.md                      â† Data flow in sidebar
â””â”€â”€ FIELD_RENDERERS.md                â† Field rendering system

docs/important/dashboard/
â”œâ”€â”€ README.md                         â† Dashboard system overview
â”œâ”€â”€ CORE_INFRASTRUCTURE.md            â† Core infrastructure
â”œâ”€â”€ AUTHENTICATION.md                 â† Auth system
â”œâ”€â”€ DATA_FLOWS.md                     â† Data flows
â”œâ”€â”€ MODULES.md                        â† Module breakdown
â”œâ”€â”€ DEBUGGING.md                      â† Debugging guide
â””â”€â”€ RELATED_SYSTEMS.md                â† Related systems

docs/important/GA4/
â”œâ”€â”€ README.md                         â† Google Analytics overview
â””â”€â”€ ARCHITECTURE.md                   â† GA4 architecture
```

**RULE:** Read when working on these specific systems.

---

### **ğŸŸ¢ TIER 3: SYSTEM-WIDE REFERENCES**

```
docs/important/
â”œâ”€â”€ COMPONENT_LOADING_SYSTEM.md       â† How components load
â”œâ”€â”€ componentsCachingSystem.md        â† Caching system
â”œâ”€â”€ AUTHENTICATION_SYSTEMS.md         â† Auth systems
â”œâ”€â”€ LOCALE_ROUTING_SYSTEM.md          â† Routing & locales
â”œâ”€â”€ MIDDLEWARE_TENANT_DETECTION.md    â† Tenant detection
â”œâ”€â”€ RECAPTCHA_SYSTEM.md               â† reCAPTCHA integration
â”œâ”€â”€ metaDataIntegration.md            â† SEO metadata
â”œâ”€â”€ editorSidebarTranslationSystem.md â† Translation system
â””â”€â”€ ifDataDoesntExistPutTheDefaultDataOnTheEditorSidebar.md
```

**RULE:** Reference when touching these specific systems.

---

## ğŸš¨ CRITICAL RULES - NEVER BREAK

### **1. COMPONENT SYSTEM RULES**

```typescript
// âœ… ALWAYS follow the 7-step component pattern
// âœ… ALWAYS use 4 required functions (ensureVariant, getData, setData, updateByPath)
// âœ… ALWAYS use uniqueId (props.id) NOT variantId
// âœ… ALWAYS merge data: defaults â†’ store â†’ props
// âœ… ALWAYS use mergedData in render, NOT props directly

// âŒ NEVER skip switch cases in editorStore
// âŒ NEVER forget to export in index files
// âŒ NEVER use props.* directly in render
// âŒ NEVER create component without following ADD_NEW_COMPONENT.md
```

**REFERENCE:** `docs/important/components/ADD_NEW_COMPONENT.md`

---

### **2. STATE MANAGEMENT RULES**

```typescript
// âœ… ALWAYS use Zustand stores correctly
// âœ… ALWAYS update both componentStates AND pageComponentsByPage
// âœ… ALWAYS use componentFunctions from editorStoreFunctions/
// âœ… ALWAYS maintain state immutability

// âŒ NEVER mutate state directly
// âŒ NEVER bypass store functions
// âŒ NEVER forget to initialize component in store
```

**REFERENCE:** `docs/important/liveEditor/STATE_MANAGEMENT.md`

---

### **3. INTEGRATION RULES**

```typescript
// When adding/modifying components, UPDATE ALL:
// 1. context-liveeditor/editorStoreFunctions/{component}Functions.ts
// 2. componentsStructure/{component}.ts
// 3. components/tenant/{component}/{component}1.tsx
// 4. context-liveeditor/editorStore.ts (import, state, 4 switch cases, functions)
// 5. lib-liveeditor/ComponentsList.tsx (import, getComponents, COMPONENTS)
// 6. componentsStructure/index.ts (export)
// 7. context-liveeditor/editorStoreFunctions/index.ts (export)

// âœ… Follow checklist in ADD_NEW_COMPONENT.md
// âŒ Never skip integration steps
```

**REFERENCE:** `docs/important/components/ADD_NEW_COMPONENT.md` (Steps 1-9)

---

### **4. DOCUMENTATION MAINTENANCE RULES**

```markdown
## When you CHANGE implementation:

1. CHECK: Does documentation need updating?
2. IF YES:
   - Update relevant docs in docs/important/
   - Update code examples
   - Update diagrams/flowcharts if present
   - Add note in doc about change date
3. ALWAYS: Keep docs in sync with code

## Documentation Update Triggers:

âœ… Adding new component type
âœ… Changing store structure
âœ… Modifying data flow
âœ… Adding/removing functions
âœ… Changing patterns/conventions
âœ… Adding new features
âœ… Fixing major bugs that affect architecture
âœ… Changing file structure
âœ… Modifying integration points
```

**REFERENCE:** `docs/important/MAINTENANCE_GUIDE.md` (will be created)

---

## ğŸ” BEFORE MAKING CHANGES - CHECKLIST

```
â–¡ Read relevant documentation
â–¡ Understand current architecture
â–¡ Check existing patterns
â–¡ Verify no breaking changes
â–¡ Follow established conventions
â–¡ Test with multiple instances (for components)
â–¡ Update documentation if needed
â–¡ Run linter/TypeScript checks
â–¡ Test in Live Editor (for components)
```

---

## ğŸ› ï¸ COMPONENT WORK WORKFLOW

### **Creating New Component:**
```
1. Read: @docs/important/components/ADD_NEW_COMPONENT.md
2. Use:  @docs/important/components/ADD_NEW_COMPONENT_PROMPT.md
3. Follow: 9-step process exactly
4. Test: All functionality
5. Verify: Checklist at end of guide
```

### **Fixing Existing Component:**
```
1. Read: @docs/important/components/FIX_COMPONENT_PROMPT.md
2. Run: All 7 diagnostic layers
3. Fix: Issues in priority order
4. Verify: Post-repair checklist
5. Update: Documentation if architecture changed
```

### **Modifying Component:**
```
1. Check: Current implementation
2. Read: Component architecture docs
3. Plan: Changes maintaining patterns
4. Implement: Following conventions
5. Test: Thoroughly
6. Update: Docs if patterns changed
```

---

## ğŸ“‹ COMMON TASKS - QUICK REFERENCE

### **Task: Add New Component "pricing"**
```
STEP 1: Read @docs/important/components/ADD_NEW_COMPONENT.md
STEP 2: Use template from ADD_NEW_COMPONENT_PROMPT.md
STEP 3: Follow 9 steps exactly
STEP 4: Test in Live Editor
STEP 5: Run through verification checklist
```

### **Task: Fix Broken Component "testimonials"**
```
STEP 1: Use @docs/important/components/FIX_COMPONENT_PROMPT.md
STEP 2: Run 7 diagnostic layers
STEP 3: Apply fixes in priority order
STEP 4: Verify all fixes work
STEP 5: Re-test in Live Editor
```

### **Task: Modify editorStore**
```
STEP 1: Read @docs/important/liveEditor/STATE_MANAGEMENT.md
STEP 2: Understand current architecture
STEP 3: Make changes following patterns
STEP 4: Update all switch cases if needed
STEP 5: Test all affected components
STEP 6: Update docs if architecture changed
```

### **Task: Add Field to Component**
```
STEP 1: Update default data in {component}Functions.ts
STEP 2: Add field to {component}.ts structure
STEP 3: Use field in React component with mergedData
STEP 4: Test in EditorSidebar
STEP 5: Verify saves/loads correctly
```

---

## ğŸ¯ CONTEXT AWARENESS

### **When User Says "fix component X":**
```
1. Ask which specific issue (or run full diagnostic)
2. Reference: @docs/important/components/FIX_COMPONENT_PROMPT.md
3. Execute: Diagnostic layers
4. Apply: Fixes in priority order
5. Report: Detailed results
```

### **When User Says "create component X":**
```
1. Ask for requirements (or use defaults)
2. Reference: @docs/important/components/ADD_NEW_COMPONENT.md
3. Use: ADD_NEW_COMPONENT_PROMPT.md templates
4. Execute: All 9 steps
5. Verify: Complete checklist
```

### **When User Says "update X":**
```
1. Read relevant documentation
2. Understand current implementation
3. Plan changes maintaining conventions
4. Implement changes
5. Update docs if needed
```

---

## ğŸ”„ AUTO-UPDATE PROTOCOL

### **When Code Changes Are Made:**

```typescript
// AI CHECKLIST:

1. DETECT what changed:
   - Component files?
   - Store structure?
   - Integration points?
   - Patterns/conventions?

2. CHECK which docs are affected:
   - Component docs?
   - Architecture docs?
   - Pattern docs?
   - API reference?

3. PROMPT user if docs need updating:
   "I've changed [X]. The following docs may need updating:
   - docs/important/[Y].md
   - docs/important/[Z].md
   
   Should I update these docs to reflect the changes?"

4. IF user confirms:
   - Update relevant sections
   - Update code examples
   - Update diagrams if needed
   - Add "Last Updated" date

5. ALWAYS mention doc updates in completion message
```

---

## ğŸ“Š FILE ORGANIZATION RULES

### **Component Files:**
```
context-liveeditor/editorStoreFunctions/
  â””â”€â”€ {componentType}Functions.ts         â† 4 functions + default data

componentsStructure/
  â””â”€â”€ {componentType}.ts                  â† Structure & fields

components/tenant/{componentType}/
  â””â”€â”€ {componentType}1.tsx                â† React component
```

### **Store Files:**
```
context-liveeditor/
  â”œâ”€â”€ editorStore.ts                      â† Main store
  â”œâ”€â”€ tenantStore.jsx                     â† Tenant data
  â””â”€â”€ editorI18nStore.ts                  â† Translations
```

### **Integration Files:**
```
lib-liveeditor/
  â””â”€â”€ ComponentsList.tsx                  â† Component registry

componentsStructure/
  â””â”€â”€ index.ts                            â† Export all structures

context-liveeditor/editorStoreFunctions/
  â””â”€â”€ index.ts                            â† Export all functions
```

---

## ğŸš€ PERFORMANCE RULES

```typescript
// âœ… DO:
- Use React.memo for expensive components
- Minimize store subscriptions
- Use proper dependencies in useEffect
- Implement proper cleanup

// âŒ DON'T:
- Subscribe to entire store unnecessarily
- Create infinite render loops
- Forget cleanup in useEffect
- Mutate state directly
```

---

## ğŸ§ª TESTING REQUIREMENTS

### **For Components:**
```
â–¡ Appears in Live Editor component list
â–¡ Can drag and drop to canvas
â–¡ Renders without errors
â–¡ EditorSidebar opens and works
â–¡ All fields editable
â–¡ Changes update in real-time
â–¡ Data saves to database
â–¡ Data loads correctly from database
â–¡ Multiple instances work independently
â–¡ No console errors
â–¡ No TypeScript errors
```

### **For Store Changes:**
```
â–¡ State updates correctly
â–¡ Re-renders triggered properly
â–¡ No infinite loops
â–¡ Data persists correctly
â–¡ No memory leaks
â–¡ Works with all components
```

---

## ğŸ’¬ COMMUNICATION STYLE

When responding to user:

```markdown
âœ… DO:
- Reference specific documentation
- Explain WHY following pattern
- Show before/after comparisons
- Provide verification steps
- Mention if docs updated

âŒ DON'T:
- Make changes without understanding docs
- Break established patterns
- Skip integration steps
- Forget to update docs when needed
- Ignore TypeScript errors
```

---

## ğŸ“ LEARNING FROM EXAMPLES

### **Good Examples to Study:**
```
components/tenant/hero/hero1.tsx          â† Perfect 7-step pattern
context-liveeditor/editorStoreFunctions/heroFunctions.ts
componentsStructure/hero.ts
```

### **Complex Examples:**
```
components/tenant/testimonials/testimonials1.tsx  â† Array handling
context-liveeditor/editorStoreFunctions/contactCardsFunctions.ts  â† Extended functions
```

---

## ğŸ”— QUICK LINKS

```
Component Creation:  docs/important/components/ADD_NEW_COMPONENT.md
Component Repair:    docs/important/components/FIX_COMPONENT_PROMPT.md
Architecture:        docs/important/liveEditor/COMPONENT_ARCHITECTURE.md
State Management:    docs/important/liveEditor/STATE_MANAGEMENT.md
Integration:         docs/important/liveEditor/context/COMPONENT_INTEGRATION.md
All Docs Index:      docs/important/INDEX.md
Maintenance Guide:   docs/important/MAINTENANCE_GUIDE.md
```

---

## ğŸ¯ PRIORITY RULES

1. **CORRECTNESS** over speed
2. **CONSISTENCY** over cleverness
3. **DOCUMENTATION** is as important as code
4. **PATTERNS** must be followed strictly
5. **TESTING** is mandatory

---

## ğŸ“ VERSION CONTROL

```
When committing changes:

âœ… Clear commit messages
âœ… Reference issue/task if applicable
âœ… Mention doc updates in commit
âœ… Group related changes together
âœ… Test before committing
```

---

## ğŸ¨ CODE STYLE

```typescript
// âœ… Follow existing patterns:
- Use TypeScript properly (no any unless necessary)
- Consistent naming (camelCase for vars, PascalCase for components)
- Proper indentation (2 spaces)
- Clear comments for complex logic
- Organize imports (React â†’ Next â†’ External â†’ Internal)

// âŒ Don't:
- Mix styles
- Use inconsistent naming
- Leave debug console.logs
- Ignore linter warnings
```

---

## ğŸ”š FINAL CHECKLIST

Before saying "done" on any task:

```
â–¡ Code works as expected
â–¡ Follows all patterns/conventions
â–¡ No TypeScript/linter errors
â–¡ No console errors
â–¡ Documentation updated (if needed)
â–¡ Tested thoroughly
â–¡ All integration points verified
â–¡ User informed of any doc updates
```

---

## ğŸ“ WHEN STUCK

```
1. Re-read relevant documentation
2. Check similar existing implementations
3. Look for patterns in codebase
4. Ask user for clarification if needed
5. Reference docs in your questions
```

---

**REMEMBER:** 
- Documentation is the **single source of truth**
- Patterns exist for a **reason** - follow them
- **Test thoroughly** - bugs are expensive
- **Update docs** - future you will thank you

---

**END OF RULES**

These rules ensure consistency, maintainability, and quality across the entire project.

